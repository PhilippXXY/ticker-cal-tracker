@startuml sequence_diagram_delete_user
title Delete User - Sequence Diagram

actor User
participant "Application" as APP
database "SQL Database" as DB

User -> APP: DELETE /api/user

== Authentication & Validation ==
APP -> APP: Validate user authentication and permission
APP -> APP: Validate payload

== User Deletion ==
APP -> DB: BEGIN;
APP -> DB: DELETE FROM "user" WHERE id=:user_id\n-- ON DELETE CASCADE handles user_preference, watchlist, follow
alt deletion successful
  APP -> DB: COMMIT;
  APP --> User: 204 No Content
else deletion failed
  APP -> DB: ROLLBACK;
  APP --> User: 500 Server Error { code: DELETE_FAILED }
end
@enduml
