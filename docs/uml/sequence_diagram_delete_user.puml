@startuml sequence_diagram_delete_user
title Delete User - Sequence Diagram

actor User
participant "UserREST" as REST
database "SQL Database" as DB


User -> REST: DELETE /api/user/profile

== Authentication ==
REST -> REST: auth_utils.get_current_user_id()

== Delete User with Cascade ==
REST -> DB: DELETE FROM users\nWHERE id = :user_id

note right
  ON DELETE CASCADE will automatically delete:
  - All watchlists owned by the user
  - All watchlist_settings for those watchlists
  - All follows for those watchlists
end note

DB --> REST: rows_affected

alt deletion successful
  REST --> User: 204 No Content
else user not found
  REST --> User: 404 Not Found
end

@enduml
